"use strict";(self["webpackChunkmijia"]=self["webpackChunkmijia"]||[]).push([[754],{79754:function(e,t,r){r.r(t),r.d(t,{default:function(){return u}});var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"warp"},[t("div",{staticStyle:{"margin-bottom":"20px"}},[t("el-dropdown",[t("el-button",{staticStyle:{"background-color":"#e9f3fb",color:"#279dff"},attrs:{type:"primary"}},[e._v(" 角色状态"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",[e._v("黄金糕")]),t("el-dropdown-item",[e._v("狮子头")]),t("el-dropdown-item",[e._v("螺蛳粉")]),t("el-dropdown-item",[e._v("双皮奶")]),t("el-dropdown-item",[e._v("蚵仔煎")])],1)],1),t("div",{staticStyle:{width:"312px",display:"inline-block","margin-left":"20px"}},[t("el-input",{staticStyle:{width:"86%","margin-top":"-6px","border-top-right-radius":"0px","border-bottom-right-radius":"0px"},attrs:{placeholder:"请输入角色名称进行模糊搜索"},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}}),t("div",{staticClass:"wrap_conter",on:{click:function(t){return e.search()}}},[t("i",{staticClass:"el-icon-search"})])],1),t("div",{staticStyle:{float:"right"},on:{click:function(t){return e.add()}}},[t("el-button",{attrs:{type:"primary"}},[e._v("+ 添加系统角色")])],1)],1),t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{select:e.ppp,"select-all":e.qx}},[t("el-table-column",{style:e.a,attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{label:"角色名称",width:"180"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("span",[e._v(e._s(r.row.rolename))])]}}])}),t("el-table-column",{attrs:{label:"角色描述",width:"180"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("span",[e._v(e._s(r.row.describe))])]}}])}),t("el-table-column",{attrs:{label:"角色权限配置",width:"180"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("span",[e._v(e._s(r.row.powers.replace("0","开放所有权限").replace("1","首页").replace("2","企业管理").replace("3","通话统计").replace("4","并发统计").replace("5","权限管理").replace("6","系统校色管理").replace("7","系统用户管理").replace("8","系统配置").replace("9","呼转计费").replace("10","客户端版本维护")))])]}}])}),t("el-table-column",{attrs:{label:"角色启用状态",width:"180"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("div",{class:r.row.status?"green":"red",staticStyle:{display:"inline-block"}}),t("span",[e._v(e._s(r.row.status?"启用中":"已停用"))])]}}])}),t("el-table-column",{attrs:{prop:"date",label:"最后编辑时间",sortable:"",width:"180"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("span",[e._v(e._s(e.formattedDate(r.row.lasttime)))])]}}])}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("i",{staticClass:"el-icon-edit icon",on:{click:function(t){return e.handleEdit(r.$index,r.row)}}}),t("i",{staticClass:"el-icon-delete icon",on:{click:function(t){return e.handleDelete(r.$index,r.row)}}}),t("i",{class:r.row.status?"el-icon-switch-button icon":"el-icon-video-play icon",on:{click:function(t){return e.stop(r.$index,r.row)}}})]}}])})],1),t("el-dialog",{attrs:{title:"收货地址",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"活动名称",prop:"name"}},[t("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:"描述",prop:"describe"}},[t("el-input",{model:{value:e.ruleForm.describe,callback:function(t){e.$set(e.ruleForm,"describe",t)},expression:"ruleForm.describe"}})],1),t("el-form-item",{attrs:{label:"是否启用",prop:"resource"}},[t("el-radio-group",{model:{value:e.ruleForm.resource,callback:function(t){e.$set(e.ruleForm,"resource",t)},expression:"ruleForm.resource"}},[t("el-radio",{attrs:{label:"启用"}}),t("el-radio",{attrs:{label:"停用"}})],1)],1),t("el-form-item",{attrs:{label:"权限配置",prop:"authority"}},[t("div",[t("el-tree",{ref:"tree",attrs:{data:e.arr,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":"",props:e.defaultProps,"default-checked-keys":e.abcd}}),t("div",{staticClass:"buttons"},[t("el-button",{on:{click:e.resetChecked}},[e._v("清空权限配置")])],1)],1)]),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("添加")]),t("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1),t("div",{staticClass:"buttom"},[t("div",{staticStyle:{float:"left"}},[t("p",{on:{click:function(t){return e.toggleSelection(e.tableData)}}},[e._v(" 已选 "),t("span",[e._v(e._s(e.selectedRowCount))]),e._v(" 条 ")]),t("p",{on:{click:function(t){return e.BatchDel()}}},[e._v("批量删除")]),t("p",{on:{click:function(t){return e.BatchStop()}}},[e._v("批量启用/停用角色")])]),t("div",{staticStyle:{float:"right"}},[t("div",{staticClass:"block"},[t("el-pagination",{attrs:{background:"","current-page":e.currentPage4,"page-size":e.suum,layout:"total, sizes, prev, pager, next, jumper",total:e.sum,"page-count":10},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])])],1)},s=[],a=r(59263),o={data(){return{abcd:[],suum:10,sum:1,currentPage4:1,selectedRowCount:0,selectedRows:[],a:{checked:!0},props:{label:"name",children:"zones"},power:"",count:1,tableData:[],input:"",name:"",dialogFormVisible:!1,status:"",ruleForm:{name:"",describe:"",authority:"",resource:""},ary:[],rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{max:8,message:"不能大于8个字符",trigger:"blur"}],resource:[{required:!0,message:"是否启用",trigger:"change"}],authority:[{required:!0,message:"请选择",trigger:"blur"}]},arr:[{id:0,label:"开放所有权限",children:[{id:1,label:"首页"},{id:2,label:"企业管理"},{id:3,label:"通话统计",children:[{id:4,label:"并发统计"}]},{id:5,label:"权限管理",children:[{id:6,label:"系统角色管理"},{id:7,label:"系统用户管理"}]},{id:8,label:"系统配置",children:[{id:9,label:"呼转计费"},{id:10,label:"客户端版本维护"}]}]}],defaultProps:{children:"children",label:"label"}}},methods:{handleEdit(e,t){this.dialogFormVisible=!0;let r={id:t.id,rolename:t.rolename,describe:t.describe,status:"启用"==t.resource?1:0,powers:t.powers};this.ruleForm.name=t.rolename,this.ruleForm.describe=t.describe,this.ruleForm.resource=t.status?"启用":"停用",this.abcd=t.powers.split(","),console.log(e,t,r)},handleSizeChange(e){console.log(`每页 ${e} 条`),this.fun({pagelimit:e})},handleCurrentChange(e){console.log(`当前页: ${e}`),this.fun({page:e})},BatchStop(){this.ary.forEach((e=>{e.id}))},BatchDel(){this.$confirm("确定要删除吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.ary.forEach((e=>{console.log(e.id),(0,a.BJ)(e.id).then((e=>{console.log(e),this.fun()})),this.$message({type:"success",message:"删除成功!"})}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},qx(e){this.selectedRowCount=e.length,console.log(e)},ppp(e){this.selectedRowCount=e.length,this.ary=e},stop(e,t){1==t.status?this.status="停用":this.status="启用",this.$confirm(`确认${this.status}${t.rolename}角色？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let e={id:t.id,status:!t.status};(0,a.oQ)(e).then((e=>{console.log(e,t.status),this.fun()})),this.$message({type:"success",message:"停用成功!"})})).catch((()=>{this.$message({type:"info",message:"已取消停用"})}))},formattedDate(e){const t=new Date(1e3*e);return`${t.getFullYear()}-${r(t.getMonth()+1)}-${r(t.getDate())} ${r(t.getHours())}:${r(t.getMinutes())}:${r(t.getSeconds())}`;function r(e){return e<10?"0"+e:e}},resetChecked(){this.$refs.tree.setCheckedKeys([])},resetForm(e){this.$refs[e].resetFields()},submitForm(){let e={rolename:this.ruleForm.name,describe:this.ruleForm.describe,status:"启用"==this.ruleForm.resource?1:0,powers:this.$refs.tree.getCheckedKeys().join(",")};(0,a.r9)(e).then((e=>{console.log(e),this.fun(),this.resetChecked(),this.dialogFormVisible=!1,this.ruleForm.name="",this.ruleForm.describe=""}))},add(){this.dialogFormVisible=!0},search(){(0,a.UL)({rolename:this.input}).then((e=>{this.tableData=e.data.data}))},fun(e){(0,a.qt)(e).then((e=>{this.tableData=e.data.data,this.sum=e.data.pagecount}))},handleDelete(e){this.$confirm(`删除后，${e.rolename}将不再具备角色响应的权限`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,a.BJ)(e.id).then((e=>{console.log(e),this.fun()})),this.$message({type:"success",message:"删除成功!"})})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))}},created(){this.fun()}},i=o,n=r(81656),c=(0,n.A)(i,l,s,!1,null,"645a124c",null),u=c.exports}}]);
//# sourceMappingURL=754.72b2319c.js.map